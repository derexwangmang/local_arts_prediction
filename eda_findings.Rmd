---
title: "EDA Findings"
author: "Elena Andrews, Derex Wangmang"
date: "April 21, 2021"
output:
  html_document:
    toc: true
    toc_float: true
    highlight: "tango"
    code-folding: true
---

## Load Packages and Set Seed

```{r packages-seed, message = FALSE}
# Load Necessary Packages
library(tidyverse)
library(tidymodels)
library(naniar)
library(skimr)

# Set Seed
set.seed(3206)
```


## Initial Overview

The arts, from plays to musicals to live jazz, give us hope, meaning, connection and community. Particularly local arts brings us closer to the communities we engage with on a daily basis. Further, by better understanding who attends arts performances and exhibits and how often they do, as well as why other people don't, we can, hopefully, make the arts more accessible to *everyone*. Thus, for our predictive modeling project, we will be using a dataset we from the Local Area Arts Participation study from 1992. This study was funded by the National Endowment for the Arts (Research Division) and conducted by Abt Associates of Cambridge, MA. It contains information on whether and how often Americans attend and participate in various kinds of local art, including jazz concerts, ballet performances, etc. It also contains various demographic characteristics of the respondents. In collecting the data, Abt Associates randomly selected Americans from 12 localities via a random-digit-dialing sampling methodology and contacted them by phone for this survey.

In total, there are 5,040 total observations and 95 attributes. 72 of the characteristics are factored data while the other 23 are numeric data. The categorical characteristics generally involve whether the respondent attended or participated in local art as well as demographic data. The numerical features include the number of times the respondent attended that specific event as well as demographic data. The data is read in below, and named `local_arts_data`.

```{r load-data}
# Load the Data
load(file = "data/processed/local_arts_data.Rda")
```

## Outcome Variable

In our predictive modeling project, we will attempt to predict survey respondent's household income, the variable `income`. This is a categorical variable with 9 levels indicating the range of the respondent's household income. Before conducting an initial split on the data into a training and testing set, we wanted to visualize our outcome variable. 

```{r income-distribution}
# Distribution of income (graph)
local_arts_data %>%
  ggplot(aes(x = income)) +
  geom_bar() +
  coord_flip() +
  labs(
    title = "Distribution of Respondent's Household Income"
  ) +
  theme_minimal()

# Table of the levels of income
local_arts_data %>% 
  count(income)
```

As the graph and table above show, there is a significant amount of missingness in the outcome variable, with a total of 915 missing values. Most of this missingness is because participants didn't know their household income or because the respondent refused to answer the question, with some `NA` values being truly missing responses. For the rest of the data, the categories with the highest counts are `$50,000 to $74,000`, `$30,000 to $39,999`, and `$20,000 to $29,999`. Before spliting the data into a training and test set, it would make sense to get rid of the rows that contain missing values, since it would not make sense (nor would it be possible) to predict missing values. The code for that is below.

```{r filter-out-na-income}
# Only keep observations with values for income
local_arts_data <- local_arts_data %>% 
  filter(!is.na(income))
```


Further, the imbalance between the various classes of `income` prove that it would be important to stratify our initial split (and later our cross-validation) by `income`.

## Missingness

There appears to be significant missingness within some characteristics of the data. These are due to three reasons that this missingness occurs:

- The respondent did not know the answer.
- The question did not apply to this respondent.
- The respondent refused to answer the question.

The majority of NA values are due to the second reasonâ€”that the question did not apply to the respondent. For instance, the columns with the most missing values, `bar5` and `bar4`, ask about the fourth and fifth reasons for why the respondent did not attend cultural and artistic events more often. However, the previous three questions, `bar1`, `bar2`, and `bar3`, ask the same question, and it's likely that most respondents didn't have more than three reasons for not atttending more cultural/artistic events. Another example is `mags`, which asks what magazines the respondent read to learn about art events in the community, which would be dependent on whether the respondent read magazines and cited them as a source for learning about art events. For those that do not fall under that category, it is more likely that the respondent did not know the answer to the question than that they refused to the question or that the question didn't apply to them.

Below is a table of the missingness in the local arts data.

```{r, message = FALSE}
# Create function to select columns with missing values
has_na <- function(x){
  any(is.na(x))
}

# Graph missingness
local_arts_data %>%
  # select only columns that have missing values
  select_if(has_na) %>%
  # summary of missing variables
  miss_var_summary() %>% 
  print(n = Inf)
```

The table above shows that there are 77 variables with missingness in our data set. Some variables, have a significant amount of missingness. In the table, variables from `bar5` down to `newsp` have over 20% of their values as `NA`. For those variables with more than 20% missingness, it would probably make sense to remove most of them as predictors since more than 20% missingness is a lot to impute. We decided to remove 14 predictors with a significant amount of missingness (`bar5`, `bar4`, `mags`, `more8`, `bar3`, `more7`, `radio`, `more6`, `tvtype`, `bar2`, `more5`, `more4`, `more3`, `newsp`). The code for that is below.

```{r remove-predictors-na}
local_arts_data <- local_arts_data %>% 
  select(-bar5, -bar4, -mags, -more8, -bar3, -more7, -radio, -more6, 
         -tvtype, -bar2, -more5, -more4, -more3, -newsp)
```


For the rest of the variables with missingness at or below 20%, an imputation step will be used to replace those missing values. 

## Splitting

We have decided to initially split the data into 70% training, and 30% testing. As mentioned before, we are stratifying by `income` due to the class imbalance in this variable. Below is the code for splitting the data.

```{r split-data}
# Conduct Initial Split
local_arts_split <- initial_split(data = local_arts_data, prop = 0.7, strata = income)

# Collect Training Data
local_arts_train <- training(local_arts_split)
```


## Essential Findings

### Predictor Variables

After performing some initial cleaning and processing of the dataset, there are 74 variables remaining, 73 of which may serve as predictor variables. Of these, the demographic variables (such as education level, `educ`, `race`, `gender`, and `age`) seem as if they could provide valuable insight into the income of the participant, as income generally increases with age and education. Their participation in the arts may also correlate with their income, as high participation in the arts may signal more available time for leisure activities. There are two sets of variables indicating participation in the arts: one set that is categorical, indicating whether or not the participant has gone to the indicated arts event in the last 12 months. The other set is numeric, indicating how many times the participant has gone to the indicated arts event in the last 12 months. Using both sets of variables might be a bit redundant, so we may focus on the numeric set rather than the categorical set, as that would give us a more nuanced look at not only whether or not the participant has been to certain arts events but the *frequency* with which they have attended those events.

Taking a look at both the relationship between both thee categorical and numeric sets of predictor variables regarding participation in the arts and our outcome variable `income` shows that there is definitely a trend. 

```{r arts-attendence-1}
# combined graph of categorical arts participation variables
local_arts_train %>% 
  select(income, jazz, classic, opera, musical, play, ballet, museum, fair) %>%
  gather(-income, key = "var", value = "value") %>%
  ggplot(aes(x = income, fill = value)) +
  geom_bar(position = "fill") +
  coord_flip() +
  facet_wrap(~ var, scales = "free") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45)) +
  labs(
    title = "Attendance at Arts Activities by Income",
    fill = "have you\nattended\nin last\n 12 months?",
    x = "prop"
  )
```

As you can see above, for every kind of local art activity, from live jazz, to a museum, to a staged play, the proportion of people who have attended in the last 12 months increases as you move up the income brackets. For each local art activity, the income bracket with the most people who attended in the last 12 months is the `$100,000 or more` income bracket. This makes sense: those with more money have the financial ability and time to attend local arts events. The same pattern seems to hold when we look at the numeric representation of arts attendance and participation.

```{r arts-attendence-2}
# combined graph of numeric arts participation variables
local_arts_train %>%
  select(income, starts_with("n")) %>%
  filter(!is.na(income)) %>%
  select(., 1:10) %>%
  gather(-income, key = "var", value = "value") %>%
  ggplot(aes(x = value, y = income)) +
  geom_boxplot() +
  facet_wrap(~ var, scales = "free") +
  theme_minimal() +
  coord_cartesian(xlim = c(0, 10)) +
  theme(axis.text.x = element_text(angle = 45)) +
  labs(
    title = "Frequency of Attendance at Arts Activities by Income",
    x = "number of times attending"
  )
```

It's a little hard to see a relationship for a lot of the variables, since so many people went zero times to a local arts performance. But for some variables, there does seem to be a positive relationship between the frequency of arts attendance and income. For example, people with an income of 100,000 dollars or more and those with an income between 75,000 and 99,999 visited museums in the last twelve months a median of 2 times, while those with lower household incomes visited museums on the whole less frequently. In addition, people with a household income of 20,000 dollars or more had a higher median number of visits to art fairs (`nfair`) than those with an income under 20,000 dollars.

Below is another graph of `income` in relations to more variables indicating the number of times the respondent participated in a specific activity. `nbooks` refers to the number of books the respondent read in the last 12-months, `npark` refers to the number of times the respondent visited a history park/monument in the last twelve months, `ntvart` refers to the number of times the respondent watched a visual arts program on TV/VCR in the last twelve months, `ntvclass` refers to the number of times the respondent watched a classical music program on TV/VCR in the last twelve months, `ntvdance` refers to the number of times a respondent watched a dance program on TV in the last twelve months, `ntvjazz` refers to the number of times a respondent watched a jazz program on TV in th elast twelv months, `ntvmus` refers to the number of times a respondent watched a musical on TV in the last twelve months, `ntvopera` refers to the number of times a respondent watched opera on TV in last twelve months, and `ntvplay` refers to the number of times a respondent watched a play on TV in the last twelve months.

```{r arts-attendence-3}
# combined graph of numeric arts participation variables 2
local_arts_train %>%
  select(income, starts_with("n")) %>%
  filter(!is.na(income)) %>%
  select(., 1, 11:19) %>%
  gather(-income, key = "var", value = "value") %>%
  ggplot(aes(x = value, y = income)) +
  geom_boxplot() +
  facet_wrap(~ var, scales = "free") +
  theme_minimal() +
  coord_cartesian(xlim = c(0, 20)) +
  theme(axis.text.x = element_text(angle = 45)) +
  labs(
    title = "Frequency of Engaging in/Watching Arts Activities by Income",
    x = "number of times engaging"
  )
```

Again, since the majority of people watched or engaged in most of the above arts activities zero times in the last twelve months, there isn't much of a relationship between most of the variables and income, except for `nbooks` and `npark`. There is a very clear relationship between the income of a respondent and the numnber of books they read in the last twelve months, with those with the highest income reading the most and those with the lowest income reading the least. There also seems to be a slight relationship between the income of a respondent and the number of times they visited a historic park or monument, with those with the highest income visiting historic sites slightly more frequently then those with the lowest income.

Another predictor variable related to arts participation/engagement that we think would be interesting to investigate in relation to income is whether or not a person visited the movies in the past twelve months.

```{r cinema}
local_arts_data %>% 
  ggplot(aes(income, fill = cinema)) +
  geom_bar(position = "fill") +
  coord_flip() +
  theme_minimal() +
  labs(title = "Going to the movies by income",
       fill = "Have you gone to movie theater\nto see a movie\nin last 12 months?",
       y = "prop")
```

The graph pretty clearly shows that more people with higher incomes went to see a movie in the theaters in the last twelve months than people with lower incomes.

Since we've seen in many of the previous graphs, a lot of people have not attended or engaged in arts activities in the last twelve months. It would be important to get a sense of why this is the case, and thus we can take a look at the variable `bar1`, which indicates respondent's first reason for not attending local arts events/not attending them more often.

```{r dist-bar1}
# distribution of bar1
local_arts_train %>% 
  mutate(
    bar1 = bar1 %>% fct_infreq() %>% fct_rev()
  ) %>% 
  ggplot(aes(bar1)) +
  geom_bar() +
  coord_flip() +
  labs(
    x = "reason for not attending"
  )
```

As you can see above, the most common reason for people not attending local arts events more frequently is that they don't have time, followed by the cost of tickets and lack of childcare. It could also be interesting to see how these reasons for not attending local arts events change (or remain the same) across levels of `income`.

```{r}
# distribution of bar1 by income
local_arts_train %>% 
  mutate(
    bar1 = bar1 %>% fct_infreq() %>% fct_rev()
  ) %>% 
  ggplot(aes(bar1)) +
  geom_bar() +
  facet_wrap(~ income) +
  coord_flip() +
  labs(
    x = "reason for not attending"
  )
```

It seems that across all income levels, lack of time is the primary reason for not attending local arts events more frequently. 


```{r}
local_arts_train %>%
  select(income, hhsize, over18, age, marital, educ, race, income, gender, weight) %>%
  filter(!is.na(income)) %>%
  select(income, hhsize) %>%
  ggplot(aes(hhsize)) +
  geom_bar() +
  facet_wrap(~ income, scales = "free") +
  theme_minimal()
```

## Secondary Findings








Some activities, such as reading books, are widely accessible than others, such as attending a live opera. As such, the expected predictor variables are in the table below.

```{r}
local_arts_train %>%
  select(starts_with("n"), hhsize, over18, age, marital, educ, race, income, gender, weight)
```