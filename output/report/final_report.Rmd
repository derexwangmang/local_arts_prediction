---
title: 'Local Arts in America: A Predictive Modeling Project'
author: "Elena Andrews and Derex Wangmang"
date: "6/9/2021"
output: 
 html_document:
    toc: true
    toc_float: true
    highlight: "tango"
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## Load Necessary Packages

```{r}
library(tidyverse)
library(tidymodels)
library(naniar)
```

## Introduction

The arts in all forms, from live jazz, to operas, plays, classical symphonies, musicals, and dance performances, are a ubiquitous facet of modern life. Museums, theaters, small music venues and symphony halls are present in cities across the country and the world. They are often integral parts of how we define both our residential spaces and our culture, because of the ways in which participation in and exposure to the arts bring joy, meaning, and community into our lives. A pressing subject that we as data scientists, lovers of the arts, and American citizens wish to investigate, however, is the link between participation in the arts in America and various demographic and social factors, particularly income. That is why for our predictive modeling project, we have decided to utilize a data-set from the Local Area Arts Participation study from 1992. This study was funded by the National Endowment for the Arts (Research Division) and conducted by Abt Associates of Cambridge, MA. It contains information on whether and how often Americans attended and participated in various kinds of local art, including jazz concerts, ballet performances, etc. It also contains various demographic characteristics of the respondents. In collecting the data, Abt Associates randomly selected 5,040 Americans from 12 localities (Broward County, Chicago, Dade County, Las Vegas, Pittsburgh, Reno, Rural Nevada, San Jose, Seattle, Sedona, Winston-Salem) via a random-digit-dialing sampling methodology and contacted them by phone for this survey, .

Thus, it is our intention to utilize the various variables regarding arts participation in this data-set, as well as demographic information like race, gender, and age, to predict the household income of the respondents in this survey. Hopefully, through the process of predicting respondent income, we can better understand who attends arts performances and exhibits, how often they do, and why other people don't in order to eventually make the arts more accessible and appealing to *everyone*.

## Data Overview and Missingness

The data from the Local Area Arts Participation study was downloaded from the National Archive of Data on Arts and Culture (see appendix for citation). It required some minor cleaning before it was ready for use in this project. This cleaning involved first converting the data into a tibble format. We also had to change data values from `NA` to zero in certain variables in which, given the context, this made more sense. (For example, those respondents who said they had not attended a jazz concert in the last 12 months should have a corresponding value of zero, rather than just `NA`, for the next variable/question, in which the respondents were asked how many *times* they attended a jazz concert in the last 12 months. This was the case for all similarly formatted pairs of variables.) Further, in all categorical variables, we decided to convert levels of `Don't know` and `Refused` to `NA`. Also, for numeric variables, missing values were coded as numbers (as 98 and 99) and thus we had to be sure to correct that in order to read the data correctly. We also made a few other minor adjustments to the data, such as dropping a few variables that we knew from the get-go would be irrelevant to our project, re-coding the names of the levels of `income` (our outcome variable) for easier readability, and cleaning the names of our variables to be in snake case.

After cleaning, we wrote out our processed data-set into an .rda file, which is read in below. The data is named `local_arts_data`. There are 5,040 total observations and 88 attributes. 65 of the characteristics are factored data while the other 23 are numeric data. The categorical characteristics generally involve whether the respondent attended or participated in local art, as well as demographic data. The numerical features include the number of times the respondent attended that specific event as well as numeric demographic data.

```{r load-data}
# Load the Data
load(file = "data/processed/local_arts_data.Rda")
```

After reading in the data, we performed an exploration of missingness. The results in the form of a table and a graph are shown below.

```{r, message = FALSE, fig.height=8}
# Create function to select columns with missing values
has_na <- function(x){
  any(is.na(x))
}

# table of missingness
local_arts_data %>%
  # select only columns that have missing values
  select_if(has_na) %>%
  # summary of missing variables (from naniar)
  miss_var_summary() %>% 
  print(n = Inf)

# graph missingness
local_arts_data %>% 
  # select only columns that have missing values
  select_if(has_na) %>% 
  # create missingness graph (from naniar)
  gg_miss_var()
```

80 of the 88 variables in our data-set contain missingness, some with a considerable amount of missingness. As can be seen in the table, over 20% of the values of variables from `bar5` down to `moremost` are `NA`. That's 18 variables with more than 20% of their values missing. The majority of the variables with missingness, however, do not have more than 20% of their values missing. We postulated that there are three reasons that this missingness occurs:

- The respondent did not know the answer.
- The question did not apply to this respondent.
- The respondent refused to answer the question.

The majority of NA values are due to the second reasonâ€”that the question did not apply to the respondent. For instance, the columns with the most missing values, `bar5` and `bar4`, ask about the fourth and fifth reasons for why the respondent did not attend cultural and artistic events more often. However, the previous three questions, `bar1`, `bar2`, and `bar3`, ask the same question, and it's likely that most respondents didn't have more than three reasons for not attending more cultural/artistic events. Thus, variables `bar5` and `bar4` did not apply to the respondent given that their reasons for not attending more cultural/artistic events were covered in their responses to `bar1`, `bar2`, and `bar3`. Another example is `mags`, which asks what magazines the respondent read to learn about art events in the community. The response that a person gives to this question would be dependent whether the respondent read magazines and cited them as a source for learning about art events *in the first place*  (ie, their responses to the `source` variables, which as where a respondent learned about arts events in their community). Thus, if people didn't learn about arts events through magazines (which clearly few people did given how many missing values this variable has), then they would not respond to this question and their value for this variable would be `NA`. For those predictors with missing values that do not fall under the category of the question not applying to the respondent, it is more likely that the respondent simply did not know the answer to the question/how to respond to the question than that they refused to answer the question.

For the variables with more than 20% missingness, we decided it would make sense to remove most of them, as more than 20% of observations are a lot to impute. We decided to remove 14 predictors with a significant amount of missingness: `bar5`, `bar4`, `mags`, `more8`, `bar3`, `more7`, `radio`, `more6`, `tvtype`, `bar2`, `more5`, `more4`, `more3`, `newsp`. The code for that is below.

```{r remove-predictors-na}
local_arts_data <- local_arts_data %>% 
  select(-bar5, -bar4, -mags, -more8, -bar3, -more7, -radio, -more6, 
         -tvtype, -bar2, -more5, -more4, -more3, -newsp)
```

We decided to keep one variable that had greater than 20% missingness, specifically `mostimp`, as that question relates to the most important reason the participant did not attend arts events more often.

For the rest of the variables with missingness at or below 20%, an imputation step will be used to replace those missing values in our model recipes.

## Outcome Variable

In our predictive modeling project, we will attempt to predict the survey respondent's household income, the variable `income`, using as predictors the other variables in the data-set, which are related to arts attendence and demographic information. `income` is a categorical variable with 9 levels indicating the range of the respondent's household income. Before conducting an initial split on the data into a training and testing set, we wanted to visualize the outcome variable to understand it's distribution and check for problems. 

```{r income-distribution}
# Distribution of income (graph)
local_arts_data %>%
  ggplot(aes(x = income)) +
  geom_bar() +
  coord_flip() +
  labs(
    title = "Distribution of Respondent's Household Income"
  ) +
  theme_minimal()

# Table of the levels of income
local_arts_data %>% 
  count(income)
```

As the graph and table above show, there is a significant amount of missingness in the outcome variable, with a total of 915 missing values. Most of this missingness is because participants didn't know their household income or because the respondent refused to answer the question, with some `NA` values being truly missing responses. For the rest of the data, the income categories with the highest counts are `$50,000 to $74,999`, `$30,000 to $39,999`, and `$20,000 to $29,999`. Categories with the lowest counts are `$75,000 to $99,000` and `$100,000 or more`. Before splitting the data into a training and test set, it would make sense to get rid of the rows that contain missing values, since it would not make sense (nor would it be possible) to predict missing values. The code for that is below.

```{r filter-out-na-income}
# Only keep observations with values for income
local_arts_data <- local_arts_data %>% 
  filter(!is.na(income))
```

## Splitting and Cross Validation

We decided to initially split the data into 70% training, and 30% testing. The imbalance between the various classes of `income` shown above prove that it would be important to stratify our initial split (and later our cross-validation) by `income`. Below is the code for splitting the data.

```{r split-data}
# Conduct Initial Split
local_arts_split <- initial_split(data = local_arts_data, prop = 0.7, strata = income)

# Collect Training Data
local_arts_train <- training(local_arts_split)

# Collect Testing Data
local_arts_test <- testing(local_arts_split)
```

After conducting an initial split, the training data was also folded using 5-fold cross-validation with 3 repeats. These folds were used later during the tuning process to collect reliable information on model performance and avoid overfitting. The code used to create the folds is below. 

```{r cross-validation}
local_arts_fold <- vfold_cv(data = local_arts_train, v = 5, repeats = 3, strata = income)
```

## Exploratory Data Analysis

Exploratory data analysis is a vital step in the modeling process. This is where relationships between the outcome and predictor variables are analyzed, and variables are examined for any problematic qualities that will need to be addressed in a model recipe. 

After removing variables with a significant amount of missingness, there are 74 variables remaining, 73 of which may serve as predictor variables. To begin our exploratory data analysis, we thought it would make sense to explore the relationship between `income` and the various variables that deal with attendence at/engagement with the arts. There are two sets of variables indicating participation in the arts. One set is categorical, indicating whether or not the participant has gone to the indicated arts event in the last 12 months. The other set is numeric, indicating how many *times* the participant has gone to the indicated arts event in the last 12 months. First, let's look at how income is related to the *categorical* arts variables, ie whether or not a person has attended an arts event in the last 12 months. 
